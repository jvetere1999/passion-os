/**
 * PHASE 5: Vendor Prefixes & CSS Property Support
 * Ensures cross-browser compatibility for animations and CSS features
 * 
 * Added prefixes:
 * - -webkit- (Safari, Chrome older versions, iOS)
 * - -moz- (Firefox older versions)
 * - -ms- (Internet Explorer, Edge older versions)
 * - -o- (Opera older versions)
 */

:root {
  /* ===== Color Tokens ===== */
  /* Light theme (default) */
  --bg-primary: #ffffff;
  --bg-secondary: #f5f5f5;
  --bg-tertiary: #e8e8e8;
  --bg-elevated: #ffffff;

  --surface-default: #fafafa;
  --surface-hover: #f0f0f0;
  --surface-active: #e8e8e8;
  --surface-selected: #f0f0f0;

  --text-primary: #1a1a1a;
  --text-secondary: #666666;
  --text-muted: #999999;
  --text-inverse: #ffffff;

  --border-default: #d0d0d0;
  --border-subtle: #e5e5e5;
  --border-strong: #a0a0a0;

  --accent-primary: #1976d2;
  --accent-secondary: #7cb342;
  --accent-success: #4caf50;
  --accent-warning: #ff9800;
  --accent-error: #f44336;

  --selection-bg: rgba(25, 118, 210, 0.2);
  --selection-text: #1976d2;
  --focus-ring: #1976d2;

  --keycap-bg: #e8e8e8;
  --keycap-text: #1a1a1a;
  --keycap-border: #b0b0b0;
  --keycap-modifier-bg: #666666;
  --keycap-modifier-text: #ffffff;

  --waveform-bg: #f5f5f5;
  --waveform-wave: #1976d2;
  --waveform-playhead: #f44336;
  --waveform-region: rgba(25, 118, 210, 0.15);
  --waveform-marker: #7cb342;

  --player-bg: #fafafa;
  --player-controls: #1a1a1a;
  --player-progress: #1976d2;

  --row-odd: #ffffff;
  --row-even: #f9f9f9;
  --row-hover: #f0f0f0;
  --row-selected: #e3f2fd;

  --tag-bg: #e3f2fd;
  --tag-text: #1976d2;
  --badge-bg: #f44336;
  --badge-text: #ffffff;

  /* ===== Typography Tokens ===== */
  --font-family-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, 
                      "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji";
  --font-family-mono: "Menlo", "Monaco", "Courier New", monospace;

  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.25rem;
  --font-size-2xl: 1.5rem;
  --font-size-3xl: 1.875rem;
  --font-size-4xl: 2.25rem;

  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
  --line-height-loose: 2;

  /* ===== Spacing Tokens ===== */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;
  --spacing-3xl: 4rem;

  /* ===== Animation/Transition Tokens ===== */
  /* With vendor prefixes for maximum compatibility */
  --transition-fast: 150ms ease-in-out;
  --transition-normal: 250ms ease-in-out;
  --transition-slow: 350ms ease-in-out;

  /* Webkit prefix (Safari, Chrome) */
  --webkit-transition-fast: 150ms ease-in-out;
  --webkit-transition-normal: 250ms ease-in-out;
  --webkit-transition-slow: 350ms ease-in-out;

  /* ===== Z-Index Scale ===== */
  --z-dropdown: 1000;
  --z-sticky: 1010;
  --z-fixed: 1020;
  --z-modal-backdrop: 1030;
  --z-modal: 1040;
  --z-popover: 1050;
  --z-tooltip: 1070;

  /* ===== Component Tokens ===== */
  --button-padding: 0.625rem 1.25rem;
  --input-padding: 0.625rem 1rem;
  --card-padding: 1rem;
  --modal-padding: 1.5rem;

  --card-border-radius: 0.5rem;
  --input-border-radius: 0.375rem;
  --button-border-radius: 0.375rem;

  --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.08);
  --card-shadow-hover: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
}

/* ===== Dark Theme ===== */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #121212;
    --bg-secondary: #1e1e1e;
    --bg-tertiary: #2a2a2a;
    --bg-elevated: #2a2a2a;

    --surface-default: #1e1e1e;
    --surface-hover: #2a2a2a;
    --surface-active: #333333;
    --surface-selected: #1f5a96;

    --text-primary: #e5e5e5;
    --text-secondary: #b0b0b0;
    --text-muted: #808080;
    --text-inverse: #121212;

    --border-default: #444444;
    --border-subtle: #333333;
    --border-strong: #666666;

    --accent-primary: #64b5f6;
    --accent-secondary: #aed581;
    --accent-success: #81c784;
    --accent-warning: #ffb74d;
    --accent-error: #ef5350;

    --selection-bg: rgba(100, 181, 246, 0.2);
    --selection-text: #64b5f6;
    --focus-ring: #64b5f6;

    --keycap-bg: #2a2a2a;
    --keycap-text: #e5e5e5;
    --keycap-border: #555555;
    --keycap-modifier-bg: #555555;
    --keycap-modifier-text: #e5e5e5;

    --waveform-bg: #1e1e1e;
    --waveform-wave: #64b5f6;
    --waveform-playhead: #ef5350;
    --waveform-region: rgba(100, 181, 246, 0.15);
    --waveform-marker: #aed581;

    --player-bg: #1e1e1e;
    --player-controls: #e5e5e5;
    --player-progress: #64b5f6;

    --row-odd: #121212;
    --row-even: #1a1a1a;
    --row-hover: #252525;
    --row-selected: #1a3a52;

    --tag-bg: #0d47a1;
    --tag-text: #64b5f6;
    --badge-bg: #c62828;
    --badge-text: #ffffff;
  }
}

/* ===== Animations with Vendor Prefixes ===== */

/* Fade In */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@-webkit-keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@-moz-keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Slide In Up */
@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(1rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@-webkit-keyframes slideInUp {
  from {
    opacity: 0;
    -webkit-transform: translateY(1rem);
    transform: translateY(1rem);
  }
  to {
    opacity: 1;
    -webkit-transform: translateY(0);
    transform: translateY(0);
  }
}

@-moz-keyframes slideInUp {
  from {
    opacity: 0;
    -moz-transform: translateY(1rem);
    transform: translateY(1rem);
  }
  to {
    opacity: 1;
    -moz-transform: translateY(0);
    transform: translateY(0);
  }
}

/* Scale In */
@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@-webkit-keyframes scaleIn {
  from {
    opacity: 0;
    -webkit-transform: scale(0.95);
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    -webkit-transform: scale(1);
    transform: scale(1);
  }
}

/* Pulse */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@-webkit-keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ===== Utility Classes with Prefixes ===== */

.animate-fade-in {
  -webkit-animation: fadeIn var(--transition-normal) ease-in-out;
  animation: fadeIn var(--transition-normal) ease-in-out;
}

.animate-slide-in-up {
  -webkit-animation: slideInUp var(--transition-normal) ease-in-out;
  animation: slideInUp var(--transition-normal) ease-in-out;
}

.animate-scale-in {
  -webkit-animation: scaleIn var(--transition-normal) ease-in-out;
  animation: scaleIn var(--transition-normal) ease-in-out;
}

.animate-pulse {
  -webkit-animation: pulse var(--transition-slow) ease-in-out infinite;
  animation: pulse var(--transition-slow) ease-in-out infinite;
}

/* ===== Text Utilities ===== */
.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }
.text-accent { color: var(--accent-primary); }
.text-success { color: var(--accent-success); }
.text-warning { color: var(--accent-warning); }
.text-error { color: var(--accent-error); }

/* ===== Background Utilities ===== */
.bg-primary { background-color: var(--bg-primary); }
.bg-secondary { background-color: var(--bg-secondary); }
.bg-tertiary { background-color: var(--bg-tertiary); }
.bg-elevated { background-color: var(--bg-elevated); }

/* ===== Surface Utilities ===== */
.surface { background-color: var(--surface-default); }
.surface-hover { background-color: var(--surface-hover); }
.surface-active { background-color: var(--surface-active); }

/* ===== Border Utilities ===== */
.border-default { border: 1px solid var(--border-default); }
.border-subtle { border: 1px solid var(--border-subtle); }
.border-strong { border: 1px solid var(--border-strong); }

/* ===== Transition Utilities with Prefixes ===== */
.transition-fast {
  -webkit-transition: all var(--transition-fast);
  -moz-transition: all var(--transition-fast);
  transition: all var(--transition-fast);
}

.transition-normal {
  -webkit-transition: all var(--transition-normal);
  -moz-transition: all var(--transition-normal);
  transition: all var(--transition-normal);
}

.transition-slow {
  -webkit-transition: all var(--transition-slow);
  -moz-transition: all var(--transition-slow);
  transition: all var(--transition-slow);
}

/* ===== Transform Utilities with Prefixes ===== */
.transform-gpu {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  will-change: transform;
}

.scale-hover:hover {
  -webkit-transform: scale(1.05);
  -moz-transform: scale(1.05);
  -ms-transform: scale(1.05);
  -o-transform: scale(1.05);
  transform: scale(1.05);
}

/* ===== Accessibility: Reduced Motion ===== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    -webkit-animation-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
    -webkit-animation-iteration-count: 1 !important;
    animation-iteration-count: 1 !important;
    -webkit-transition-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ===== Touch Device Improvements ===== */
@media (hover: none) and (pointer: coarse) {
  /* Ensure touch targets are at least 44x44px */
  button, 
  input[type="button"], 
  input[type="submit"], 
  input[type="reset"],
  input[type="checkbox"],
  input[type="radio"],
  a[role="button"],
  [role="button"] {
    min-height: 44px;
    min-width: 44px;
  }

  /* Input fields should be 44px minimum height on touch */
  input,
  textarea,
  select {
    min-height: 44px;
    /* Prevent iOS auto-zoom on input focus */
    font-size: 16px;
  }

  /* Reduce touch target gap */
  button,
  a[role="button"],
  [role="button"] {
    padding: var(--spacing-sm) var(--spacing-md);
  }
}

/* ===== Browser-Specific Fixes ===== */

/* Safari specific */
@supports (-webkit-appearance: none) {
  input[type="range"] {
    -webkit-appearance: none;
  }

  /* Smooth scrolling for iOS */
  html {
    -webkit-user-select: text;
    -webkit-touch-callout: none;
  }
}

/* Firefox specific */
@-moz-document url-prefix() {
  input[type="number"] {
    /* Remove Firefox spinner */
  }

  /* Firefox smooth scrolling */
  * {
    scroll-behavior: smooth;
  }
}

/* ===== Print Styles ===== */
@media print {
  * {
    -webkit-animation-duration: 0s !important;
    animation-duration: 0s !important;
    -webkit-transition-duration: 0s !important;
    transition-duration: 0s !important;
  }

  body {
    background-color: white;
    color: black;
  }

  a {
    text-decoration: underline;
  }

  /* Hide interactive elements in print */
  [role="button"],
  button,
  nav {
    display: none;
  }
}
