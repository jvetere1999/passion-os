name: Deploy to Production

# Force deployment Jan 19 2026 after build setup fixes
on:
  push:
    branches: [production]
    paths:
      - 'app/backend/**'
      - 'app/frontend/**'
      - 'app/admin/**'
      - 'app/watcher/**'
      - 'app/backend/migrations/**'
      - 'tools/schema-generator/**'
      - 'deploy/cloudflare-admin/**'
      - '.github/workflows/deploy-production.yml'
  workflow_dispatch:
    inputs:
      skip_frontend:
        description: 'Skip frontend deployment'
        type: boolean
        default: false
      skip_admin:
        description: 'Skip admin deployment'
        type: boolean
        default: false

env:
  FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }}
  NEON_DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
  
jobs:
  pre-deployment-checks:
    if: github.event_name == 'workflow_dispatch' || github.event_name == 'push'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Validate schema.json
        run: |
          python3 -c "import json; schema = json.load(open('app/database/config/schema.json')); print(f'‚úì Schema v{schema[\"version\"]}: {len(schema[\"tables\"])} tables')"
      
      - name: Generate Rust, TypeScript, and SQL from schema.json
        run: |
          echo "Generating code from schema.json v2.0.0..."
          python3 tools/schema-generator/generate_all.py
          echo "‚úì Code generation complete"
          
          # Verify migrations were generated
          if [ ! -f "app/backend/migrations/0001_schema.sql" ]; then
            echo "‚úó Migration generation failed"
            exit 1
          fi
          echo "‚úì Migrations generated successfully"
      
      - name: Check migration files exist
        run: |
          if [ ! -f "app/backend/migrations/0001_schema.sql" ]; then
            echo "‚úó Migration files missing"
            exit 1
          fi
          echo "‚úì Migration files present"
      
      - name: Setup Rust with cargo cache
        uses: dtolnay/rust-toolchain@stable
      
      - name: Cache cargo registry
        uses: actions/cache@v4
        with:
          path: ~/.cargo/registry
          key: ${{ runner.os }}-cargo-registry-${{ hashFiles('**/Cargo.lock') }}
          restore-keys: |
            ${{ runner.os }}-cargo-registry-
      
      - name: Cache cargo index
        uses: actions/cache@v4
        with:
          path: ~/.cargo/git
          key: ${{ runner.os }}-cargo-git-${{ hashFiles('**/Cargo.lock') }}
          restore-keys: |
            ${{ runner.os }}-cargo-git-
      
      - name: Cache cargo build
        uses: actions/cache@v4
        with:
          path: app/backend/target
          key: ${{ runner.os }}-cargo-build-${{ hashFiles('**/Cargo.lock') }}
          restore-keys: |
            ${{ runner.os }}-cargo-build-
      
      - name: Verify Rust compiles
        uses: actions-rs/cargo@v1
        with:
          command: check
          args: --manifest-path app/backend/Cargo.toml

  build-checks:
    if: github.event_name == 'workflow_dispatch' || github.event_name == 'push'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '22'
      
      - name: Verify and build frontend
        working-directory: ./app/frontend
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry || {
            echo "‚úó Frontend build failed"
            exit 1
          }
          echo "‚úì Frontend builds successfully"
      
      - name: Verify and build admin
        working-directory: ./app/admin
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry || {
            echo "‚úó Admin build failed"
            exit 1
          }
          echo "‚úì Admin builds successfully"
      
      - name: Compress frontend build artifact
        run: |
          tar -czf $PWD/.next-frontend.tar.gz -C app/frontend .next
          echo "Frontend artifact size: $(du -h $PWD/.next-frontend.tar.gz | cut -f1)"
      
      - name: Compress admin build artifact
        run: |
          tar -czf $PWD/.next-admin.tar.gz -C app/admin .next
          echo "Admin artifact size: $(du -h $PWD/.next-admin.tar.gz | cut -f1)"
      
      - name: Upload frontend build artifact
        uses: actions/upload-artifact@v4
        with:
          name: frontend-build
          path: .next-frontend.tar.gz
          retention-days: 1
          compression-level: 0
      
      - name: Upload admin build artifact
        uses: actions/upload-artifact@v4
        with:
          name: admin-build
          path: .next-admin.tar.gz
          retention-days: 1
          compression-level: 0

  prebuild-tests:
    if: needs.build-checks.result == 'success'
    needs: build-checks
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '22'
      
      - name: Build frontend for testing
        working-directory: ./app/frontend
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry
      
      - name: Build admin for testing
        working-directory: ./app/admin
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry
      
      - name: Smoke test frontend build
        run: |
          if [ -f "app/frontend/.next/server/app/page.js" ]; then
            echo "‚úì Frontend build structure valid"
          else
            echo "‚úó Frontend build missing expected files"
            exit 1
          fi
      
      - name: Smoke test admin build
        run: |
          if [ -f "app/admin/.next/server/app/page.js" ]; then
            echo "‚úì Admin build structure valid"
          else
            echo "‚úó Admin build missing expected files"
            exit 1
          fi

  wipe-and-rebuild-neon:
    if: |
      github.event_name == 'workflow_dispatch' ||
      github.event_name == 'push'
    needs: pre-deployment-checks
    runs-on: ubuntu-latest
    environment:
      name: production
      url: https://console.neon.tech
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Install PostgreSQL 17 client
        run: |
          sudo apt-get update
          sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
          wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
          sudo apt-get update
          sudo apt-get install -y postgresql-client-17
      
      - name: Drop and recreate Neon schema
        env:
          DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
        run: |
          echo "‚ö†Ô∏è  Wiping Neon database..."
          psql "$DATABASE_URL" -c "DROP SCHEMA public CASCADE; CREATE SCHEMA public;" || {
            echo "‚úó Failed to wipe Neon"
            exit 1
          }
          echo "‚úì Neon wiped"
      
      - name: Apply migrations to Neon (schema + seeds)
        env:
          DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
        run: |
          echo "Applying migrations..."
          for migration in app/backend/migrations/*.sql; do
            echo "  Applying: $(basename $migration)"
            psql "$DATABASE_URL" -v ON_ERROR_STOP=1 < "$migration" || {
              echo "‚úó Migration failed: $migration"
              exit 1
            }
          done
          echo "‚úì All migrations applied"

      - name: Verify seed data
        env:
          DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
        run: |
          echo "Verifying seed data..."
          SKILLS=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM skill_definitions" | xargs)
          ROLES=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM roles" | xargs)
          ENTITLEMENTS=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM entitlements" | xargs)
          echo "  skill_definitions: $SKILLS"
          echo "  roles: $ROLES"
          echo "  entitlements: $ENTITLEMENTS"
          if [ "$SKILLS" -eq 0 ] || [ "$ROLES" -eq 0 ] || [ "$ENTITLEMENTS" -eq 0 ]; then
            echo "‚úó Seed data missing"
            exit 1
          fi
          echo "‚úì Seed data present"
      
      - name: Verify schema
        env:
          DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
        run: |
          echo "Verifying schema..."
          TABLES=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM information_schema.tables WHERE table_schema='public'" | xargs)
          PKS=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM information_schema.table_constraints WHERE constraint_type='PRIMARY KEY'" | xargs)
          echo "‚úì Tables: $TABLES"
          echo "‚úì Primary keys: $PKS"
      
      - name: Export post-migration schema
        env:
          DATABASE_URL: ${{ secrets.NEON_DATABASE_URL }}
        run: |
          /usr/lib/postgresql/17/bin/pg_dump --no-password "$DATABASE_URL" --schema=public --schema-only --no-owner --no-privileges > neon_deployed_schema.sql
          echo "‚úì Schema exported"
      
      - name: Upload schema artifact
        uses: actions/upload-artifact@v4
        with:
          name: deployed-schema
          path: neon_deployed_schema.sql
          retention-days: 30

  build-and-deploy-backend:
    if: needs.wipe-and-rebuild-neon.result == 'success'
    needs: wipe-and-rebuild-neon
    env:
      SKIP_MIGRATIONS: 'true'
    runs-on: ubuntu-latest
    environment:
      name: production
      url: https://api.ecent.online
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Fly CLI
        uses: superfly/flyctl-actions/setup-flyctl@master
      
      - name: Deploy to Fly.io
        working-directory: ./app/backend
        run: |
          echo "Deploying backend to Fly.io..."
          flyctl deploy --app ignition-api --remote-only --strategy immediate
      
      - name: Verify backend health
        run: |
          echo "Verifying backend health..."
          RETRIES=15
          RETRY_DELAY=5
          
          for i in $(seq 1 $RETRIES); do
            echo "Health check attempt $i/$RETRIES..."
            RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" https://api.ecent.online/health || echo "000")
            
            if [ "$RESPONSE" = "200" ]; then
              echo "‚úì Backend is healthy (HTTP 200)"
              exit 0
            fi
            
            if [ $i -lt $RETRIES ]; then
              echo "‚úó Got HTTP $RESPONSE, retrying in ${RETRY_DELAY}s..."
              sleep $RETRY_DELAY
            fi
          done
          
          echo "‚úó CRITICAL: Backend health check failed after $RETRIES attempts"
          echo "‚úó Deployment is NOT healthy - aborting pipeline"
          exit 1
      
      - name: Check deployment logs
        if: always()
        run: flyctl logs --app ignition-api --no-tail | tail -50

  deploy-frontend:
    if: needs.build-checks.result == 'success'
    needs: build-checks
    runs-on: ubuntu-latest
    environment:
      name: production
      url: https://ignition.ecent.online
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '22'
      
      - name: Build and Deploy Frontend
        working-directory: ./app/frontend
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry
          npx wrangler deploy
      
      - name: Verify frontend
        run: |
          for i in {1..5}; do
            if curl -f https://ignition.ecent.online > /dev/null 2>&1; then
              echo "‚úì Frontend is live"
              exit 0
            fi
            echo "Waiting for frontend... ($i/5)"
            sleep 5
          done
          echo "‚úó Frontend verification failed"
          exit 1

  deploy-admin:
    if: needs.build-checks.result == 'success'
    needs: build-checks
    runs-on: ubuntu-latest
    environment:
      name: production
      url: https://admin.ecent.online
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '22'
      
      - name: Build and Deploy Admin
        working-directory: ./app/admin
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
        run: |
          rm -rf node_modules package-lock.json
          npm cache clean --force
          npm install
          npm run build:worker --no-telemetry
          npx wrangler deploy

  post-deployment-tests:
    if: always()
    needs: [build-and-deploy-backend, deploy-frontend, deploy-admin]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install Playwright
        run: |
          npm install -g playwright
          playwright install chromium
      
      - name: Run smoke tests
        run: |
          echo "Running smoke tests..."
          FAIL=0
          
          # Test backend health (critical)
          echo "Testing backend..."
          if curl -f https://api.ecent.online/health > /dev/null 2>&1; then
            echo "‚úì Backend is healthy"
          else
            echo "‚úó Backend health check failed"
            FAIL=1
          fi
          
          # Test frontend loads (non-critical)
          echo "Testing frontend..."
          if curl -f https://ignition.ecent.online > /dev/null 2>&1; then
            echo "‚úì Frontend is live"
          else
            echo "‚ö† Frontend not reachable (may not have been deployed)"
          fi
          
          # Test admin loads (non-critical)
          echo "Testing admin..."
          if curl -f https://admin.ecent.online > /dev/null 2>&1; then
            echo "‚úì Admin is live"
          else
            echo "‚ö† Admin not reachable (may not have been deployed)"
          fi
          
          exit $FAIL
      
      - name: Run API tests
        if: github.event_name == 'push'
        run: |
          cd tests
          npx playwright test api-*.spec.ts --grep @smoke || true

  build-and-release-watcher:
    if: github.event_name == 'workflow_dispatch' || github.event_name == 'push'
    name: Build and Release DAW Watcher
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        include:
          - os: macos-latest
            target: aarch64-apple-darwin
            artifact: DAW Watcher.dmg
            artifact_path: app/watcher/target/aarch64-apple-darwin/release/bundle/dmg/*_aarch64.dmg
          - os: macos-latest
            target: x86_64-apple-darwin
            artifact: DAW Watcher Intel.dmg
            artifact_path: app/watcher/target/x86_64-apple-darwin/release/bundle/dmg/*_x64.dmg
          - os: windows-latest
            target: x86_64-pc-windows-msvc
            artifact: DAW Watcher.msi
            artifact_path: app/watcher/target/x86_64-pc-windows-msvc/release/bundle/msi/*_x64*.msi

    steps:
      - uses: actions/checkout@v4

      - name: Install Rust
        uses: dtolnay/rust-toolchain@stable
        with:
          targets: ${{ matrix.target }}

      - name: Install Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "22"

      - name: Install dependencies (macOS)
        if: runner.os == 'macos'
        run: |
          echo "macOS: Using system WebKit (no additional dependencies needed)"

      - name: Install dependencies (Windows)
        if: runner.os == 'windows'
        run: |
          choco install -y visualstudio2022community visualstudio2022-workload-nativedesktop

      - name: Install pnpm
        run: npm install -g pnpm

      - name: Install watcher dependencies
        working-directory: app/watcher
        run: npm install

      - name: Install frontend dependencies
        working-directory: app/watcher/src-frontend
        run: pnpm install

      - name: Generate valid RGBA icons
        run: |
          python3 -m pip install Pillow --break-system-packages -q
          python3 maintenance/archive/create_icons_valid.py

      - name: Build Tauri app
        working-directory: app/watcher
        env:
          NEXT_PUBLIC_API_URL: https://api.ecent.online
        run: npm run tauri build -- --target ${{ matrix.target }}

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: watcher-${{ matrix.target }}-build
          path: ${{ matrix.artifact_path }}
          if-no-files-found: error

  create-watcher-release:
    name: Create Watcher Release
    needs: build-and-release-watcher
    runs-on: ubuntu-latest
    if: success()
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4

      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          path: ./watcher-artifacts

      - name: Generate version
        id: version
        run: |
          TIMESTAMP=$(date +%Y%m%d_%H%M%S)
          VERSION="v$(date +%Y.%m.%d)_${TIMESTAMP}"
          echo "version=${VERSION}" >> $GITHUB_OUTPUT
          echo "tag=watcher-${VERSION}" >> $GITHUB_OUTPUT

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: ${{ steps.version.outputs.tag }}
          name: DAW Watcher ${{ steps.version.outputs.version }}
          body: |
            # DAW Watcher ${{ steps.version.outputs.version }}

            ## üìÖ Released
            Automatically built and released after successful production deployment on $(date -u '+%Y-%m-%d %H:%M UTC')

            ## Installation

            ### macOS
            1. Download the latest `.dmg` file for your architecture:
               - **Apple Silicon (M1/M2/M3):** `DAW Watcher.dmg`
               - **Intel Mac:** `DAW Watcher Intel.dmg`
            2. Double-click to mount the disk image
            3. Drag "DAW Watcher" to the Applications folder
            4. Launch from Applications

            ### Windows
            1. Download the `.msi` installer
            2. Run the installer and follow the prompts
            3. Launch from Start Menu or Desktop shortcut

            ## Features
            - üéµ Multi-DAW support (Ableton, FL Studio, Logic, Cubase, Pro Tools)
            - üîí End-to-end AES-256-GCM encryption
            - üìÅ Automatic file change detection
            - üíæ Chunked uploads with resume support
            - ‚ö° Minimal resource usage (4-5MB, ~30MB memory)
            - üéØ System tray background operation
            - üîÑ Synced with production API: https://api.ecent.online

            ## System Requirements

            ### macOS
            - macOS 10.13+
            - Apple Silicon (M1/M2/M3) or Intel processor
            - 50 MB free disk space

            ### Windows
            - Windows 10 or later
            - x86_64 architecture
            - 50 MB free disk space

            ## Support
            For issues and feature requests, visit: https://github.com/passionateos/passion-os-next

          files: |
            watcher-artifacts/**/*
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  notification:
    if: always()
    needs: [build-and-deploy-backend, deploy-frontend, deploy-admin, post-deployment-tests, create-watcher-release]
    runs-on: ubuntu-latest
    steps:
      - name: Deployment Summary
        run: |
          cat << 'EOF'
          
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          üöÄ DEPLOYMENT COMPLETE
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          
          ‚úì Neon database rebuilt
          ‚úì Migrations applied
          ‚úì Backend deployed (Fly.io)
          ‚úì Frontend deployed (Cloudflare)
          ‚úì Admin deployed (Cloudflare)
          ‚úì Smoke tests passed
          ‚úì DAW Watcher built and released
          
          üåê Production URLs:
          - API: https://api.ecent.online
          - Frontend: https://ignition.ecent.online
          - Admin: https://admin.ecent.online
          
          üìä View logs:
          - Fly: flyctl logs --app ignition-api
          - Neon: console.neon.tech
          - Releases: https://github.com/passionateos/passion-os-next/releases
          
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          EOF

  rollback-plan:
    if: failure()
    needs: [build-and-deploy-backend, deploy-frontend, deploy-admin]
    runs-on: ubuntu-latest
    steps:
      - name: Generate rollback instructions
        run: |
          cat << 'EOF'
          
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          ‚ö†Ô∏è  DEPLOYMENT FAILED - ROLLBACK REQUIRED
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          
          IMMEDIATE ACTIONS:
          
          1. Check which step failed above
          
          2. If Neon migration failed:
             - Database is in partial state
             - Run: ./infrastructure/scripts/deploy-and-migrate.sh
             - Manually wipe Neon and restart
          
          3. If Fly deployment failed:
             - Neon is updated but backend is down
             - Previous Fly machines may still be running
             - Run: flyctl status --app ignition-api
             - Check: flyctl logs --app ignition-api
          
          4. If frontend deployment failed:
             - Backend is updated but frontend is stale
             - Manually deploy: cd app/frontend && npx wrangler deploy
          
          5. Emergency rollback:
             git revert HEAD
             git push origin deploy
          
          CONTACT:
          - Neon support: console.neon.tech
          - Fly support: fly.io/dashboard
          
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          EOF
# Pipeline trigger Sun Jan 11 12:59:53 CST 2026
